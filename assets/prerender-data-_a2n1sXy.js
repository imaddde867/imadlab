import{r as i,j as e}from"./vendor-BWaHT4c5.js";import{u as E,I as N,B as j,s as R}from"./index-C2wzmnot.js";const _=({className:d=""})=>{const[s,f]=i.useState(""),[m,h]=i.useState(!1),[r,l]=i.useState("idle"),[a,c]=i.useState(null),{toast:u}=E(),b=i.useRef(null),g=i.useRef(null),x=i.useRef(null),v=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),y=t=>{const n=t.target.value;f(n),a&&c(null),r!=="idle"&&l("idle")};i.useEffect(()=>{r!=="idle"&&x.current&&x.current.focus()},[r]);const p=async t=>{var n,w;if(t.preventDefault(),!s.trim()){c("Email is required"),(n=b.current)==null||n.focus();return}if(!v(s)){c("Please enter a valid email address"),(w=b.current)==null||w.focus();return}c(null),h(!0);try{const{error:o}=await R.from("newsletter_subscribers").insert([{email:s.trim()}]);o?o.code==="23505"?(l("already-subscribed"),u({title:"Already subscribed",description:"This email is already subscribed to the newsletter.",variant:"default"})):(l("error"),u({title:"Error",description:"Failed to subscribe. Please try again.",variant:"destructive"}),console.error("Error subscribing:",o)):(l("success"),u({title:"Success!",description:"Thanks for subscribing! You'll receive updates on new content."}),f(""))}catch(o){l("error"),u({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"}),console.error("Unexpected error:",o)}finally{h(!1)}};return e.jsx("section",{className:`py-8 sm:py-12 border-t border-white/10 mt-12 sm:mt-16 ${d}`,"aria-labelledby":"newsletter-heading",children:e.jsx("div",{className:"container-site",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 sm:gap-8 lg:gap-12 items-start lg:items-center",children:[e.jsxs("div",{className:"w-full lg:w-2/5 mb-6 lg:mb-0",children:[e.jsx("h2",{id:"newsletter-heading",className:"text-xl sm:text-2xl font-bold mb-2 sm:mb-3",children:"Stay Updated"}),e.jsx("p",{className:"text-white/60 text-sm sm:text-base max-w-md",children:"Get notified when new projects and blog posts are published. Never miss out on the latest content."})]}),e.jsxs("div",{className:"w-full lg:w-3/5",children:[e.jsxs("form",{onSubmit:p,className:"flex flex-col sm:flex-row gap-3 sm:gap-4","aria-describedby":"newsletter-description",noValidate:!0,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"newsletter-email",className:"sr-only",children:"Email address"}),e.jsx(N,{id:"newsletter-email",ref:b,type:"email",placeholder:"Your email address",value:s,onChange:y,required:!0,"aria-required":"true","aria-invalid":!!a,"aria-describedby":a?"email-error":"newsletter-description",className:`bg-zinc-900/80 border ${a?"border-red-400":"border-white/10"} text-white placeholder:text-white/40 rounded-lg px-4 py-3 focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all w-full`,onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),p(t))}}),a&&e.jsx("p",{id:"email-error",className:"mt-1 text-red-400 text-xs",role:"alert",children:a}),e.jsx("span",{id:"newsletter-description",className:"sr-only",children:"Enter your email to subscribe to our newsletter and receive updates on new content."})]}),e.jsx(j,{ref:g,type:"submit",disabled:m,className:"bg-white/10 hover:bg-white/20 text-white font-semibold rounded-lg py-3 transition-colors border border-white/10 shadow whitespace-nowrap h-[42px] sm:h-auto w-full sm:w-auto","aria-busy":m,children:m?"Subscribing...":"Subscribe"})]}),e.jsxs("div",{className:"min-h-[24px] mt-2",ref:x,tabIndex:r!=="idle"?-1:void 0,role:r!=="idle"?"status":void 0,"aria-live":"polite",children:[r==="success"&&e.jsx("p",{className:"text-green-400 text-xs sm:text-sm",children:"Thanks for subscribing! You'll receive updates on new content."}),r==="error"&&e.jsx("p",{className:"text-red-400 text-xs sm:text-sm",children:"Something went wrong. Please try again."}),r==="already-subscribed"&&e.jsx("p",{className:"text-yellow-400 text-xs sm:text-sm",children:"This email is already subscribed to the newsletter."})]})]})]})})})},S="__PRERENDERED_DATA__",T=d=>{if(typeof window>"u")return;const s=window[S];if(!(!s||!(d in s)))return s[d]};export{_ as N,T as r};
