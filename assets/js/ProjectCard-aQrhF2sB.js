import{j as c}from"./index-B1IGmRtD.js";import{C as d}from"./CardItem-Bp5V002J.js";import{u as p}from"./useQuery-BA7-oFOl.js";const l=t=>t.replace(/\.git$/i,"").trim(),f=t=>{if(!t)return null;const r=t.trim();if(!r)return null;const e=r.match(/^git@github\.com:([^/]+)\/([^/]+?)(?:\.git)?$/i);if(e)return{owner:e[1],repo:l(e[2])};try{const n=new URL(r);if(n.hostname!=="github.com")return null;const[,o,a]=n.pathname.split("/");return!o||!a?null:{owner:o,repo:l(a)}}catch{return null}},s=1e3*60*60*24,h=t=>`github_repo:${t.toLowerCase()}`,m=t=>{if(typeof window>"u")return null;try{const r=window.localStorage.getItem(t);if(!r)return null;const e=JSON.parse(r);return!e?.data||typeof e.expiresAt!="number"||Date.now()>e.expiresAt?null:e.data}catch{return null}},g=(t,r)=>{if(!(typeof window>"u"))try{const e={data:r,expiresAt:Date.now()+s};window.localStorage.setItem(t,JSON.stringify(e))}catch{}},u=t=>{if(typeof window>"u")return null;try{const r=window.localStorage.getItem(t);if(!r)return null;const e=JSON.parse(r);return e?.data?e.data:null}catch{return null}},w=t=>{const r=f(t),e=r?`${r.owner}/${r.repo}`:null;return p({queryKey:["github-repo",e],enabled:!!e,staleTime:s,gcTime:s*2,retry:!1,queryFn:async()=>{if(!e)return null;const n=h(e),o=m(n);if(o)return o;try{const a=await fetch(`https://api.github.com/repos/${e}`,{headers:{Accept:"application/vnd.github+json"}});if(!a.ok)return u(n);const i=await a.json();return i?.full_name?(g(n,i),i):u(n)}catch{return u(n)}}})},C=({project:t,linkTo:r,linkLabel:e="View Project"})=>{const{data:n}=w(t.repo_url),o=t.description?.trim()||n?.description?.trim()||(t.tech_tags?.length?`Built with ${t.tech_tags.slice(0,3).join(", ")}.`:"");return c.jsx(d,{title:t.title,tags:t.tech_tags||[],description:o,linkTo:r,linkLabel:e,githubUrl:t.repo_url||void 0,demoUrl:t.demo_url||void 0,image_url:t.image_url||void 0,repoStars:n?.stargazers_count??null,repoUpdatedAt:n?.pushed_at??n?.updated_at??null})};export{C as P,f as p,w as u};
