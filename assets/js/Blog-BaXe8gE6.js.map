{"version":3,"file":"Blog-BaXe8gE6.js","sources":["../../../src/pages/Blog.tsx"],"sourcesContent":["import { useMemo, useRef, useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/integrations/supabase/client';\nimport { Link } from 'react-router-dom';\nimport CardItem from '@/components/ui/CardItem';\nimport { ArrowLeft } from 'lucide-react';\nimport SEO from '@/components/SEO';\nimport SectionHeader from '@/components/SectionHeader';\nimport NewsletterSignup from '@/components/NewsletterSignup';\nimport { readPrerenderData } from '@/lib/prerender-data';\nimport { getTopTags, tagToUrl } from '@/lib/tags';\nimport { POST_SUMMARY_SELECT } from '@/lib/content-selects';\nimport type { PostSummary } from '@/types/content';\n\ntype PostSort = 'newest' | 'oldest' | 'shortest' | 'title-asc';\n\nconst Blogs = () => {\n  const initialPosts = useMemo(() => readPrerenderData<PostSummary[]>('posts'), []);\n  const initialUpdatedAt = useRef<number | undefined>(initialPosts?.length ? Date.now() : undefined);\n  const [sortBy, setSortBy] = useState<PostSort>('newest');\n\n  const {\n    data: posts = [],\n    isLoading,\n    isFetching,\n  } = useQuery({\n    queryKey: ['posts'],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('posts')\n        .select(POST_SUMMARY_SELECT)\n        .order('published_date', { ascending: false });\n\n      if (error) throw error;\n      return data as PostSummary[];\n    },\n    initialData: initialPosts?.length ? initialPosts : undefined,\n    initialDataUpdatedAt: initialUpdatedAt.current,\n    staleTime: 1000 * 60,\n  });\n\n  const isSkeletonVisible = isLoading && !posts.length && !isFetching;\n\n  const sortedPosts = useMemo(() => {\n    if (posts.length <= 1) return posts;\n    const list = [...posts];\n    const getPublishedTime = (post: PostSummary) => new Date(post.published_date).getTime();\n    const getReadTime = (post: PostSummary) => post.read_time ?? Number.POSITIVE_INFINITY;\n\n    switch (sortBy) {\n      case 'oldest':\n        return list.sort((a, b) => getPublishedTime(a) - getPublishedTime(b));\n      case 'shortest':\n        return list.sort((a, b) => getReadTime(a) - getReadTime(b));\n      case 'title-asc':\n        return list.sort((a, b) => a.title.localeCompare(b.title, undefined, { sensitivity: 'base' }));\n      case 'newest':\n      default:\n        return list.sort((a, b) => getPublishedTime(b) - getPublishedTime(a));\n    }\n  }, [posts, sortBy]);\n\n  // Derive popular tags from posts (top 12)\n  const popularTags = useMemo(() => getTopTags(posts, (post) => post.tags), [posts]);\n\n  const postItemOrder =\n    sortBy === 'oldest' || sortBy === 'shortest' || sortBy === 'title-asc'\n      ? 'Ascending'\n      : 'Descending';\n  const postListSchema =\n    sortedPosts.length > 0\n      ? [\n          {\n            '@context': 'https://schema.org',\n            '@type': 'ItemList',\n            name: 'Latest blog posts',\n            itemListOrder: postItemOrder,\n            numberOfItems: sortedPosts.length,\n            itemListElement: sortedPosts.map((post, index) => ({\n              '@type': 'ListItem',\n              position: index + 1,\n              url: `https://imadlab.me/blogs/${post.slug}`,\n              name: post.title,\n              description: post.excerpt ?? undefined,\n            })),\n          },\n        ]\n      : undefined;\n\n  return (\n    <div className=\"min-h-screen bg-black text-white section pt-14\">\n      <SEO\n        title=\"Blog\"\n        description=\"Technical notes on industrial AI systems, local LLM extraction pipelines, architecture tradeoffs, and evaluation.\"\n        keywords=\"industrial ai blog, applied research engineering notes, local llm pipelines, procedural knowledge extraction, ai system architecture, evaluation methodology\"\n        type=\"website\"\n        schemaType=\"CollectionPage\"\n        breadcrumbs={[\n          { name: 'Home', path: '/' },\n          { name: 'Blog', path: '/blogs' },\n        ]}\n        additionalSchemas={postListSchema}\n      />\n      <div className=\"container-site\">\n        <div className=\"mb-8\">\n          <Link\n            to=\"/\"\n            className=\"inline-flex items-center text-white/60 hover:text-white mb-8 transition-colors\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Home\n          </Link>\n        </div>\n        <div>\n          <SectionHeader title={<span className=\"text-brand-gradient\">Blog</span>} />\n        </div>\n\n        {(popularTags.length > 0 || posts.length > 1) && (\n          <div className=\"mb-8 flex flex-col gap-4 md:flex-row md:items-start md:justify-between\">\n            {popularTags.length > 0 && (\n              <div className=\"min-w-0\">\n                <div className=\"flex flex-wrap items-center gap-3 mb-3\">\n                  <h3 className=\"text-sm text-white/60\">Popular tags</h3>\n                  <div className=\"flex items-center gap-2 text-xs\">\n                    <Link\n                      to=\"/tags\"\n                      className=\"rounded-md border border-white/10 bg-white/5 px-2 py-1 text-white/60 hover:text-white hover:bg-white/10 transition-colors\"\n                    >\n                      All tags\n                    </Link>\n                    <Link\n                      to=\"/search\"\n                      className=\"rounded-md border border-white/10 bg-white/5 px-2 py-1 text-white/60 hover:text-white hover:bg-white/10 transition-colors\"\n                    >\n                      Search\n                    </Link>\n                  </div>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {popularTags.map((tag, index) => (\n                    <Link\n                      key={tag}\n                      to={tagToUrl(tag)}\n                      className={`px-2 py-1 text-xs bg-white/10 rounded-md text-white/90 hover:bg-white/20 ${\n                        index >= 5 ? 'hidden md:inline-flex' : 'inline-flex'\n                      }`}\n                    >\n                      #{tag}\n                    </Link>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {posts.length > 1 && (\n              <div className=\"flex items-center gap-2 text-xs text-white/60 md:pt-1\">\n                <label className=\"flex items-center gap-2\">\n                  Sort by\n                  <select\n                    value={sortBy}\n                    onChange={(event) => setSortBy(event.target.value as PostSort)}\n                    className=\"rounded-md border border-white/10 bg-white/10 px-2 py-1 text-xs text-white/90 focus:outline-none focus:ring-2 focus:ring-white/30\"\n                  >\n                    <option value=\"newest\">Newest</option>\n                    <option value=\"oldest\">Oldest</option>\n                    <option value=\"shortest\">Shortest read</option>\n                    <option value=\"title-asc\">Title A-Z</option>\n                  </select>\n                </label>\n              </div>\n            )}\n          </div>\n        )}\n\n        {isSkeletonVisible ? (\n          <div className=\"text-center py-12\">\n            <div className=\"text-white/60\">Loading posts...</div>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 grid-gap-default\">\n            {sortedPosts.map((post) => (\n              <CardItem\n                key={post.id}\n                title={post.title}\n                tags={post.tags || []}\n                date={new Date(post.published_date).toLocaleDateString()}\n                excerpt={post.excerpt || ''}\n                linkTo={`/blogs/${post.slug}`}\n                linkLabel=\"Read\"\n                isBlog={true}\n                readTime={post.read_time || undefined}\n                image_url={post.image_url || undefined}\n              />\n            ))}\n          </div>\n        )}\n\n        {!isSkeletonVisible && posts.length === 0 && (\n          <div className=\"text-center py-12\">\n            <div className=\"text-white/60 mb-4\">No posts yet</div>\n          </div>\n        )}\n      </div>\n\n      {/* Newsletter signup component */}\n      <NewsletterSignup />\n    </div>\n  );\n};\n\nexport default Blogs;\n"],"names":["Blogs","initialPosts","useMemo","readPrerenderData","initialUpdatedAt","useRef","sortBy","setSortBy","useState","posts","isLoading","isFetching","useQuery","data","error","supabase","POST_SUMMARY_SELECT","isSkeletonVisible","sortedPosts","list","getPublishedTime","post","getReadTime","a","b","popularTags","getTopTags","postItemOrder","postListSchema","index","jsxs","jsx","SEO","Link","ArrowLeft","SectionHeader","tag","tagToUrl","event","CardItem","NewsletterSignup"],"mappings":"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"}