const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/events-CLQR051h.js","assets/js/index-B1IGmRtD.js","assets/index-9eB0Q-OK.css"])))=>i.map(i=>d[i]);
import{r as i,a as y,j as e,B as j,s as N,_ as E}from"./index-B1IGmRtD.js";import{I as S}from"./input-DGhUk4PP.js";const I=({className:f=""})=>{const[l,x]=i.useState(""),[d,h]=i.useState(!1),[s,n]=i.useState("idle"),[a,o]=i.useState(null),{toast:c}=y(),u=i.useRef(null),w=i.useRef(null),m=i.useRef(null),g=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),v=t=>{const r=t.target.value;x(r),a&&o(null),s!=="idle"&&n("idle")};i.useEffect(()=>{s!=="idle"&&m.current&&m.current.focus()},[s]);const p=async t=>{if(t.preventDefault(),!l.trim()){o("Email is required"),u.current?.focus();return}if(!g(l)){o("Please enter a valid email address"),u.current?.focus();return}o(null),h(!0);try{const{error:r}=await N.from("newsletter_subscribers").insert([{email:l.trim()}]);r?r.code==="23505"?(n("already-subscribed"),c({title:"Already subscribed",description:"This email is already subscribed to the newsletter.",variant:"default"})):(n("error"),c({title:"Error",description:"Failed to subscribe. Please try again.",variant:"destructive"}),console.error("Error subscribing:",r)):(n("success"),c({title:"Success!",description:"Thanks for subscribing! You'll receive updates on new content."}),E(async()=>{const{logEvent:b}=await import("./events-CLQR051h.js");return{logEvent:b}},__vite__mapDeps([0,1,2])).then(({logEvent:b})=>b("newsletter_subscribed",{email:l.trim()})).catch(()=>{}),x(""))}catch(r){n("error"),c({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"}),console.error("Unexpected error:",r)}finally{h(!1)}};return e.jsx("section",{className:`py-8 sm:py-12 border-t border-white/10 mt-12 sm:mt-16 ${f}`,"aria-labelledby":"newsletter-heading",children:e.jsx("div",{className:"container-site",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 sm:gap-8 lg:gap-12 items-start lg:items-center",children:[e.jsxs("div",{className:"w-full lg:w-2/5 mb-6 lg:mb-0",children:[e.jsx("h2",{id:"newsletter-heading",className:"text-xl sm:text-2xl font-bold mb-2 sm:mb-3",children:"Stay Updated"}),e.jsx("p",{className:"text-white/60 text-sm sm:text-base max-w-md",children:"Get notified when new projects and blog posts are published. Never miss out on the latest content."})]}),e.jsxs("div",{className:"w-full lg:w-3/5",children:[e.jsxs("form",{onSubmit:p,className:"flex flex-col sm:flex-row gap-3 sm:gap-4","aria-describedby":"newsletter-description",noValidate:!0,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"newsletter-email",className:"sr-only",children:"Email address"}),e.jsx(S,{id:"newsletter-email",ref:u,type:"email",placeholder:"Your email address",value:l,onChange:v,required:!0,"aria-required":"true","aria-invalid":!!a,"aria-describedby":a?"email-error":"newsletter-description",className:`bg-zinc-900/80 border ${a?"border-red-400":"border-white/10"} text-white placeholder:text-white/40 rounded-lg px-4 py-3 focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all w-full`,onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),p(t))}}),a&&e.jsx("p",{id:"email-error",className:"mt-1 text-red-400 text-xs",role:"alert",children:a}),e.jsx("span",{id:"newsletter-description",className:"sr-only",children:"Enter your email to subscribe to our newsletter and receive updates on new content."})]}),e.jsx(j,{ref:w,type:"submit",disabled:d,className:"bg-white/10 hover:bg-white/20 text-white font-semibold rounded-lg py-3 transition-colors border border-white/10 shadow whitespace-nowrap h-[42px] sm:h-auto w-full sm:w-auto","aria-busy":d,children:d?"Subscribing...":"Subscribe"})]}),e.jsxs("div",{className:"min-h-[24px] mt-2",ref:m,tabIndex:s!=="idle"?-1:void 0,role:s!=="idle"?"status":void 0,"aria-live":"polite",children:[s==="success"&&e.jsx("p",{className:"text-green-400 text-xs sm:text-sm",children:"Thanks for subscribing! You'll receive updates on new content."}),s==="error"&&e.jsx("p",{className:"text-red-400 text-xs sm:text-sm",children:"Something went wrong. Please try again."}),s==="already-subscribed"&&e.jsx("p",{className:"text-yellow-400 text-xs sm:text-sm",children:"This email is already subscribed to the newsletter."})]})]})]})})})};export{I as N};
