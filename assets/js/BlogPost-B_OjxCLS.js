const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/events-CLQR051h.js","assets/js/index-B1IGmRtD.js","assets/index-9eB0Q-OK.css"])))=>i.map(i=>d[i]);
import{r as m,j as e,L as j,p as T,_,b as S,P as k,B as P,s as g}from"./index-B1IGmRtD.js";import{u as p}from"./useQuery-BA7-oFOl.js";import{S as E}from"./SEO-C_LV3HvV.js";import{c as C,s as L}from"./markdown-utils-kUX-X2ax.js";import{r as R,C as B}from"./CardItem-Bp5V002J.js";import{B as D,S as M,G as I,e as w}from"./tag-variants-DM6AmVt5.js";import{t as q}from"./tags-BdSag13u.js";import{C as A,a as U}from"./chevron-up-DFEkHWQt.js";import{P as F}from"./ProjectCard-aQrhF2sB.js";import{u as v}from"./useIntersectionObserver-Dp7KdSfc.js";import{a as O,P as $,b as K}from"./content-selects-Bl1-GPQZ.js";import{r as G}from"./prerender-data-DtJPnrxF.js";import{A as f}from"./arrow-left-DkhwOUPU.js";import{C as z}from"./clock-CDywXAON.js";import{C as H}from"./calendar-BbdJ88Zm.js";import"./SpotlightCard-Boy7UEMB.js";import"./external-link-Cz28fLjv.js";import"./copy-DLv6lLks.js";const J=({tags:s,initialVisible:r=3,label:l,variant:t="hash"})=>{const[o,n]=m.useState(!1);if(!s||s.length===0)return null;const a=o?s:s.slice(0,r),i=c=>{_(async()=>{const{logEvent:d}=await import("./events-CLQR051h.js");return{logEvent:d}},__vite__mapDeps([0,1,2])).then(({logEvent:d})=>d("tag_click",{tag:c})).catch(()=>{})};return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[l&&e.jsx("span",{className:"text-sm text-white/70",children:l}),a.map((c,d)=>e.jsx(j,{to:q(c),onClick:()=>i(c),onPointerEnter:()=>T("/tags/:tag"),className:"px-2 py-1 text-xs bg-white/10 rounded-md text-white/90 hover:bg-white/20 transition-colors",children:t==="hash"?`#${c}`:c},d)),s.length>r&&e.jsx("button",{onClick:()=>n(!o),className:"text-xs text-blue-400 hover:text-blue-300 flex items-center","aria-label":o?"Show fewer tags":"Show all tags",children:o?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"Show less"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"+",s.length-r," more"]})})]})},Q=({currentSlug:s,tags:r})=>{const l=m.useMemo(()=>w(r),[r]),{ref:t,isIntersecting:o}=v({rootMargin:"200px"}),{data:n=[]}=p({queryKey:["related-posts",s,l.slice().sort().join(",")],enabled:r.length>0&&o,queryFn:async()=>{const{data:a,error:i}=await g.from("posts").select(O).overlaps("tags",l).neq("slug",s).order("published_date",{ascending:!1}).limit(3);if(i)throw i;return a},staleTime:6e4});return!n.length&&!o?null:e.jsxs("section",{ref:t,className:"mt-12 border-t border-white/10 pt-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Related articles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map(a=>e.jsx(B,{title:a.title,tags:a.tags||[],date:new Date(a.published_date).toLocaleDateString("en-US"),excerpt:a.excerpt||"",linkTo:`/blogs/${a.slug}`,linkLabel:"Read",readTime:a.read_time||void 0,isBlog:!0,image_url:a.image_url||void 0},a.id))})]})},V=({currentSlug:s,tags:r})=>{const l=m.useMemo(()=>w(r),[r]),{ref:t,isIntersecting:o}=v({rootMargin:"200px"}),{data:n=[]}=p({queryKey:["related-projects",s,l.slice().sort().join(",")],enabled:r.length>0&&o,queryFn:async()=>{const{data:a,error:i}=await g.from("projects").select($).overlaps("tech_tags",l).order("created_at",{ascending:!1}).limit(3);if(i)throw i;return a},staleTime:6e4});return!n.length&&!o?null:e.jsxs("section",{ref:t,className:"mt-12 border-t border-white/10 pt-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Related projects"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map(a=>e.jsx(F,{project:a,linkTo:`/projects/${a.id}`,linkLabel:"View Project"},a.id))})]})},Y=(s,r)=>{if(s&&s.trim().length>60)return s.trim();if(r){const l=L(r);return l.slice(0,155)+(l.length>155?"...":"")}return"Read data engineering and AI insights by Imad Eddine El Mouss."},ue=()=>{const{slug:s}=S(),r=m.useMemo(()=>s?G(`post:${s}`):void 0,[s]),l=m.useRef(r?Date.now():void 0),{data:t,isLoading:o,error:n}=p({queryKey:["post",s],queryFn:async()=>{if(!s)throw new Error("No slug provided");const{data:h,error:b}=await g.from("posts").select(K).eq("slug",s).maybeSingle();if(b)throw b;return h},enabled:!!s,initialData:r,initialDataUpdatedAt:l.current}),a=t?.body?C(t.body):null;if(o)return e.jsx(k,{text:"Loading article...",variant:"orbit"});if(n||!t)return e.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Post Not Found"}),e.jsx("p",{className:"text-white/60 mb-8",children:"The article you're looking for doesn't exist."}),e.jsx(j,{to:"/blogs",children:e.jsxs(P,{className:"bg-white/10 hover:bg-white/20",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Back to Blog"]})})]})});const i=t.tags?.filter(h=>!!(h&&h.trim()))??[],c=Y(t.excerpt,t.body),d=[{name:"Home",path:"/"},{name:"Blog",path:"/blogs"},{name:t.title,url:`https://imadlab.me/blogs/${t.slug}`}],u=t.read_time||a||void 0,N=[{"@context":"https://schema.org","@type":"SpeakableSpecification",xpath:["//*[@id='main']//h1","//*[@id='main']//p[1]"]}],y=(t.body??"").includes("```mermaid"),x=R(t.image_url);return e.jsxs("div",{className:"min-h-screen bg-black text-white pt-14",children:[e.jsx(E,{title:t.title,description:c,keywords:i.length?i.join(", "):"data engineering, machine learning, ai, programming",type:"article",publishedTime:t.published_date,modifiedTime:t.updated_at??t.published_date,image:x||void 0,imageAlt:t.title,tags:i,breadcrumbs:d,additionalSchemas:N}),e.jsx(D,{to:"/blogs",label:"Back to Blog",icon:e.jsx(f,{className:"w-4 h-4 mr-2 transition-transform group-hover:-translate-x-1"}),right:u?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),u," min read"]}):void 0}),e.jsx("div",{className:"container-narrow mt-4",children:e.jsx(M,{title:t.title})}),e.jsx("header",{className:"relative pt-8 md:pt-12 pb-10",children:e.jsxs("div",{className:"container-narrow",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-6 leading-tight",children:t.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-y-4 gap-x-6 mb-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-white/70",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),new Date(t.published_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),i.length>0&&e.jsx(J,{tags:i,label:"Tags:"})]}),t.excerpt&&e.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed max-w-3xl",children:t.excerpt})]})}),x&&e.jsx("div",{className:"w-full container-narrow mb-12",children:e.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-lg shadow-xl",children:e.jsx("img",{src:x,alt:t.title,width:"1200",height:"675",className:"w-full h-full object-cover",loading:"lazy",decoding:"async"})})}),e.jsxs("main",{className:"container-narrow pb-16",children:[t.body?e.jsx(I,{source:t.body,className:"prose-lg",config:{enableMermaid:y}}):e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-white/60 mb-4",children:"No content available for this article."})}),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{currentSlug:t.slug,tags:i}),e.jsx(V,{currentSlug:t.slug,tags:i})]})]})]})};export{ue as default};
