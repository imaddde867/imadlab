{"version":3,"file":"ManagePosts-DDPN1_8r.js","sources":["../../../src/pages/ManagePosts.tsx"],"sourcesContent":["import { useState, useEffect, useMemo, useRef } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { PageHeader } from '@/components/ui/page-header';\nimport { Tag as TagChip } from '@/components/ui/tag';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { useToast } from '@/hooks/use-toast';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Plus, Edit, Trash2, Eye, Calendar, Clock, ExternalLink } from 'lucide-react';\nimport { calculateReadingTime } from '@/lib/markdown-utils';\nimport { POST_ADMIN_SELECT, POST_DETAIL_SELECT } from '@/lib/content-selects';\nimport type { PostAdmin } from '@/types/content';\n\ntype PostFormState = {\n  title: string;\n  slug: string;\n  body: string;\n  excerpt: string;\n  tags: string;\n  image_url: string;\n};\n\nconst createEmptyPostForm = (): PostFormState => ({\n  title: '',\n  slug: '',\n  body: '',\n  excerpt: '',\n  tags: '',\n  image_url: '',\n});\n\nconst ManagePosts = () => {\n  const [showForm, setShowForm] = useState(false);\n  const [editingPost, setEditingPost] = useState<PostAdmin | null>(null);\n  const [formData, setFormData] = useState<PostFormState>(createEmptyPostForm);\n  const [authChecked, setAuthChecked] = useState(false);\n  const [isEditLoading, setIsEditLoading] = useState(false);\n  const editRequestId = useRef(0);\n\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const checkUser = async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (!user) {\n        navigate('/admin/login');\n        toast({\n          title: 'Unauthorized',\n          description: 'Please log in to access this page.',\n          variant: 'destructive',\n        });\n      }\n      setAuthChecked(true);\n    };\n    checkUser();\n  }, [navigate, toast]);\n\n  const { data: posts, isLoading } = useQuery({\n    queryKey: ['posts'],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('posts')\n        .select(POST_ADMIN_SELECT)\n        .order('published_date', { ascending: false });\n\n      if (error) throw error;\n      return data as PostAdmin[];\n    },\n  });\n\n  const postsList = useMemo(() => posts ?? [], [posts]);\n  const totalPosts = postsList.length;\n\n  const postsThisMonth = useMemo(() => {\n    if (!postsList.length) return 0;\n    const now = new Date();\n    return postsList.filter((post) => {\n      const postDate = new Date(post.created_at);\n      return postDate.getMonth() === now.getMonth() && postDate.getFullYear() === now.getFullYear();\n    }).length;\n  }, [postsList]);\n\n  const averageReadTime = useMemo(() => {\n    if (!postsList.length) return 0;\n    const total = postsList.reduce((accumulator, post) => accumulator + (post.read_time || 0), 0);\n    return Math.round(total / postsList.length);\n  }, [postsList]);\n\n  const totalTags = useMemo(() => {\n    if (!postsList.length) return 0;\n    return new Set(postsList.flatMap((post) => post.tags || [])).size;\n  }, [postsList]);\n\n  const headerMeta = useMemo(\n    () => [\n      {\n        label: 'Total posts',\n        value: totalPosts,\n      },\n      {\n        label: 'This month',\n        value: postsThisMonth,\n      },\n      {\n        label: 'Unique tags',\n        value: totalTags,\n      },\n      {\n        label: 'Avg read',\n        value: `${averageReadTime || 0} min`,\n      },\n    ],\n    [averageReadTime, postsThisMonth, totalPosts, totalTags]\n  );\n\n  const isPostsLoading = isLoading;\n\n  const addPostMutation = useMutation({\n    mutationFn: async (newPost: Omit<PostAdmin, 'id' | 'created_at'>) => {\n      const { data, error } = await supabase\n        .from('posts')\n        .insert([\n          {\n            ...newPost,\n            tags: newPost.tags?.length ? newPost.tags : null,\n          },\n        ])\n        .select()\n        .single();\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['posts'] });\n      closeForm();\n      toast({ title: 'Post added successfully!' });\n    },\n    onError: (error) => {\n      toast({\n        title: 'Error adding post',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const updatePostMutation = useMutation({\n    mutationFn: async (updatedPost: PostAdmin) => {\n      const { data, error } = await supabase\n        .from('posts')\n        .update({\n          title: updatedPost.title,\n          slug: updatedPost.slug,\n          body: updatedPost.body,\n          excerpt: updatedPost.excerpt,\n          tags: updatedPost.tags,\n          published_date: updatedPost.published_date,\n          read_time: updatedPost.read_time,\n          image_url: updatedPost.image_url,\n        })\n        .eq('id', updatedPost.id)\n        .select()\n        .single();\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['posts'] });\n      closeForm();\n      toast({ title: 'Post updated successfully!' });\n    },\n    onError: (error) => {\n      toast({\n        title: 'Error updating post',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const isMutating = addPostMutation.isPending || updatePostMutation.isPending;\n  const isFormBusy = isMutating || isEditLoading;\n\n  const deletePostMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const { error } = await supabase.from('posts').delete().eq('id', id);\n\n      if (error) throw error;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['posts'] });\n      toast({ title: 'Post deleted successfully!' });\n    },\n    onError: (error) => {\n      toast({\n        title: 'Error deleting post',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const generateSlug = (title: string) => {\n    return title\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, '-')\n      .replace(/(^-|-$)/g, '');\n  };\n\n  const resetForm = () => setFormData(createEmptyPostForm());\n\n  const closeForm = () => {\n    editRequestId.current += 1;\n    setShowForm(false);\n    setEditingPost(null);\n    setIsEditLoading(false);\n    resetForm();\n  };\n\n  const openCreateForm = () => {\n    setShowForm(true);\n    setEditingPost(null);\n    resetForm();\n  };\n\n  const handleToggleForm = () => {\n    if (showForm) {\n      closeForm();\n    } else {\n      openCreateForm();\n    }\n  };\n\n  const handleTitleChange = (title: string) => {\n    setFormData({\n      ...formData,\n      title,\n      slug: generateSlug(title),\n    });\n  };\n\n  const handleEditClick = async (post: PostAdmin) => {\n    setEditingPost(post);\n    setShowForm(true);\n    setIsEditLoading(true);\n    const requestId = (editRequestId.current += 1);\n    try {\n      const { data, error } = await supabase\n        .from('posts')\n        .select(POST_DETAIL_SELECT)\n        .eq('id', post.id)\n        .maybeSingle();\n      if (error) throw error;\n      const record = data ?? post;\n      if (requestId !== editRequestId.current) return;\n      setFormData({\n        title: record.title,\n        slug: record.slug,\n        body: record.body || '',\n        excerpt: record.excerpt || '',\n        tags: record.tags?.join(', ') || '',\n        image_url: record.image_url || '',\n      });\n    } catch (error) {\n      console.warn('Failed to load full post content', error);\n      if (requestId !== editRequestId.current) return;\n      setFormData({\n        title: post.title,\n        slug: post.slug,\n        body: post.body || '',\n        excerpt: post.excerpt || '',\n        tags: post.tags?.join(', ') || '',\n        image_url: post.image_url || '',\n      });\n    } finally {\n      if (requestId === editRequestId.current) {\n        setIsEditLoading(false);\n      }\n    }\n  };\n\n  const handleDeleteClick = (id: string) => {\n    if (confirm('Are you sure you want to delete this post?')) {\n      deletePostMutation.mutate(id);\n    }\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (isEditLoading) {\n      toast({\n        title: 'Still loading',\n        description: 'Please wait for the full content to load before saving.',\n        variant: 'destructive',\n      });\n      return;\n    }\n    if (!formData.title.trim() || !formData.slug.trim()) return;\n\n    const tagsArray = formData.tags\n      .split(',')\n      .map((tag) => tag.trim())\n      .filter((tag) => tag.length > 0);\n\n    const postData = {\n      title: formData.title,\n      slug: formData.slug,\n      body: formData.body || null,\n      excerpt: formData.excerpt || null,\n      tags: tagsArray.length > 0 ? tagsArray : null,\n      published_date: editingPost?.published_date || new Date().toISOString(),\n      read_time: formData.body ? calculateReadingTime(formData.body) : 0,\n      image_url: formData.image_url || null,\n    };\n\n    if (editingPost) {\n      updatePostMutation.mutate({ ...editingPost, ...postData });\n    } else {\n      addPostMutation.mutate(postData);\n    }\n  };\n\n  if (!authChecked) {\n    return (\n      <div className=\"min-h-screen bg-black text-white flex items-center justify-center\">\n        <div className=\"text-white/60 text-xl\">Checking authentication...</div>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-black text-white flex items-center justify-center\">\n        <div className=\"text-white/60\">Loading posts...</div>\n      </div>\n    );\n  }\n\n  const hasPosts = postsList.length > 0;\n\n  return (\n    <div className=\"min-h-screen bg-black text-white py-12\">\n      <div className=\"container-site space-y-10 pb-24\">\n        <PageHeader\n          eyebrow=\"Admin\"\n          title=\"Blog Posts\"\n          description=\"Create, edit, and publish articles for imadlab.\"\n          breadcrumbs={[\n            { label: 'Admin', href: '/admin' },\n            { label: 'Posts', href: '/admin/posts' },\n          ]}\n          meta={headerMeta}\n          actions={\n            <Button\n              variant={showForm ? 'outline' : 'inverted'}\n              size=\"lg\"\n              onClick={handleToggleForm}\n              disabled={isMutating}\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              {showForm ? 'Cancel' : 'New Post'}\n            </Button>\n          }\n        />\n\n        {showForm && (\n          <Card className=\"rounded-2xl border border-white/10 bg-white/[0.03] shadow-none\">\n            <CardHeader>\n              <CardTitle className=\"text-white\">\n                {editingPost ? 'Edit Post' : 'Create New Post'}\n              </CardTitle>\n              <CardDescription className=\"text-white/70\">\n                {editingPost\n                  ? 'Update your blog post details'\n                  : 'Add a new blog post to your collection'}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-white/80\">Title</label>\n                    <Input\n                      placeholder=\"Enter post title\"\n                      value={formData.title}\n                      onChange={(e) => handleTitleChange(e.target.value)}\n                      className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                      required\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-white/80\">Slug</label>\n                    <Input\n                      placeholder=\"url-friendly-slug\"\n                      value={formData.slug}\n                      onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                      className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-white/80\">Excerpt</label>\n                  <Textarea\n                    placeholder=\"Brief summary of your post\"\n                    value={formData.excerpt}\n                    onChange={(e) => setFormData({ ...formData, excerpt: e.target.value })}\n                    className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                    rows={3}\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-white/80\">Content</label>\n                  <Textarea\n                    placeholder=\"Write your post content here...\"\n                    value={formData.body}\n                    onChange={(e) => setFormData({ ...formData, body: e.target.value })}\n                    className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                    rows={12}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-white/80\">Featured Image URL</label>\n                    <Input\n                      placeholder=\"https://example.com/image.jpg\"\n                      value={formData.image_url}\n                      onChange={(e) => setFormData({ ...formData, image_url: e.target.value })}\n                      className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-white/80\">Tags</label>\n                    <Input\n                      placeholder=\"react, typescript, web development\"\n                      value={formData.tags}\n                      onChange={(e) => setFormData({ ...formData, tags: e.target.value })}\n                      className=\"bg-white/5 border-white/20 text-white placeholder:text-white/50\"\n                    />\n                  </div>\n                </div>\n\n                {isEditLoading && (\n                  <div className=\"rounded-md border border-white/10 bg-white/[0.02] px-3 py-2 text-xs text-white/60\">\n                    Loading full contentâ€¦\n                  </div>\n                )}\n\n                <div className=\"flex flex-wrap gap-3\">\n                  <Button type=\"submit\" variant=\"inverted\" disabled={isFormBusy}>\n                    {editingPost\n                      ? updatePostMutation.isPending\n                        ? 'Updating...'\n                        : 'Update Post'\n                      : addPostMutation.isPending\n                        ? 'Creating...'\n                        : 'Create Post'}\n                  </Button>\n                  <Button type=\"button\" variant=\"ghost\" onClick={closeForm} disabled={isFormBusy}>\n                    Cancel\n                  </Button>\n                </div>\n              </form>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Posts List */}\n        <Card className=\"rounded-2xl border border-white/10 bg-white/[0.03] shadow-none\">\n          <CardHeader>\n            <CardTitle className=\"text-white\">All Posts</CardTitle>\n            <CardDescription className=\"text-white/70\">\n              Manage your blog posts\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isPostsLoading ? (\n              <div className=\"space-y-4\">\n                {Array.from({ length: 3 }).map((_, index) => (\n                  <div\n                    key={index}\n                    className=\"rounded-2xl border border-white/10 bg-white/[0.03] p-6\"\n                  >\n                    <Skeleton className=\"h-6 w-2/3\" />\n                    <div className=\"mt-3 flex flex-wrap gap-2\">\n                      <Skeleton className=\"h-6 w-24 rounded-full\" />\n                      <Skeleton className=\"h-6 w-20 rounded-full\" />\n                      <Skeleton className=\"h-6 w-16 rounded-full\" />\n                    </div>\n                    <Skeleton className=\"mt-5 h-4 w-full\" />\n                    <Skeleton className=\"mt-2 h-4 w-3/5\" />\n                    <div className=\"mt-6 flex flex-wrap gap-3\">\n                      <Skeleton className=\"h-9 w-24 rounded-lg\" />\n                      <Skeleton className=\"h-9 w-24 rounded-lg\" />\n                      <Skeleton className=\"h-9 w-24 rounded-lg\" />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : !hasPosts ? (\n              <div className=\"py-12 text-center\">\n                <Eye className=\"mx-auto mb-4 h-12 w-12 text-white/20\" aria-hidden=\"true\" />\n                <h3 className=\"text-lg font-semibold text-white\">No posts yet</h3>\n                <p className=\"mt-3 text-sm text-white/70\">\n                  Create your first blog post to get started.\n                </p>\n                <Button className=\"mt-6\" variant=\"inverted\" onClick={openCreateForm}>\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  Create First Post\n                </Button>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {postsList.map((post) => (\n                  <div\n                    key={post.id}\n                    className=\"rounded-2xl border border-white/10 bg-white/[0.02] p-5 transition hover:border-white/20\"\n                  >\n                    <div className=\"flex flex-col gap-4 md:flex-row md:items-start md:justify-between\">\n                      <div className=\"flex-1 space-y-3\">\n                        <div className=\"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between\">\n                          <h3 className=\"text-lg font-semibold text-white\">{post.title}</h3>\n                          {post.tags && post.tags.length > 0 && (\n                            <div className=\"flex flex-wrap gap-2\">\n                              {post.tags.slice(0, 3).map((tag, index) => (\n                                <TagChip\n                                  key={`${post.id}-tag-${index}`}\n                                  size=\"xs\"\n                                  variant=\"outline\"\n                                  className=\"text-white/80\"\n                                >\n                                  {tag}\n                                </TagChip>\n                              ))}\n                              {post.tags.length > 3 && (\n                                <TagChip size=\"xs\" variant=\"subtle\" className=\"text-white/80\">\n                                  +{post.tags.length - 3}\n                                </TagChip>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-white/70 line-clamp-2\">\n                          {post.excerpt || 'No excerpt available'}\n                        </p>\n                        <div className=\"flex flex-wrap gap-4 text-xs text-white/60\">\n                          <div className=\"flex items-center gap-1.5\">\n                            <Calendar className=\"h-3.5 w-3.5 text-white/50\" aria-hidden=\"true\" />\n                            {new Date(post.published_date).toLocaleDateString()}\n                          </div>\n                          <div className=\"flex items-center gap-1.5\">\n                            <Clock className=\"h-3.5 w-3.5 text-white/50\" aria-hidden=\"true\" />\n                            {post.read_time || 0} min read\n                          </div>\n                          <div className=\"flex items-center gap-1.5\">\n                            <ExternalLink\n                              className=\"h-3.5 w-3.5 text-white/50\"\n                              aria-hidden=\"true\"\n                            />\n                            /{post.slug}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"flex flex-wrap items-center gap-2\">\n                        <Button asChild variant=\"soft\" size=\"sm\">\n                          <Link\n                            to={`/blogs/${post.slug}`}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            <Eye className=\"mr-2 h-4 w-4\" />\n                            Preview\n                          </Link>\n                        </Button>\n                        <Button variant=\"soft\" size=\"sm\" onClick={() => handleEditClick(post)}>\n                          <Edit className=\"mr-2 h-4 w-4\" />\n                          Edit\n                        </Button>\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          onClick={() => handleDeleteClick(post.id)}\n                        >\n                          <Trash2 className=\"mr-2 h-4 w-4\" />\n                          Delete\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default ManagePosts;\n"],"names":["createEmptyPostForm","ManagePosts","showForm","setShowForm","useState","editingPost","setEditingPost","formData","setFormData","authChecked","setAuthChecked","isEditLoading","setIsEditLoading","editRequestId","useRef","toast","useToast","queryClient","useQueryClient","navigate","useNavigate","useEffect","user","supabase","posts","isLoading","useQuery","data","error","POST_ADMIN_SELECT","postsList","useMemo","totalPosts","postsThisMonth","now","post","postDate","averageReadTime","total","accumulator","totalTags","headerMeta","isPostsLoading","addPostMutation","useMutation","newPost","closeForm","updatePostMutation","updatedPost","isMutating","isFormBusy","deletePostMutation","id","generateSlug","title","resetForm","openCreateForm","handleToggleForm","handleTitleChange","handleEditClick","requestId","POST_DETAIL_SELECT","record","handleDeleteClick","handleSubmit","e","tagsArray","tag","postData","calculateReadingTime","jsx","hasPosts","jsxs","PageHeader","Button","Plus","Card","CardHeader","CardTitle","CardDescription","CardContent","Input","Textarea","_","index","Skeleton","TagChip","Calendar","Clock","ExternalLink","Link","Eye","Edit","Trash2"],"mappings":"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"}