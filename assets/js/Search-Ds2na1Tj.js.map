{"version":3,"mappings":"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","names":["normalize","value","includesNormalized","text","normalizedQuery","Search","q","setQ","useState","debounced","setDebounced","useEffect","t","posts","useQuery","data","error","supabase","POST_SEARCH_SELECT","projects","PROJECT_SEARCH_SELECT","results","useMemo","term","postHits","p","projectHits","__vitePreload","logEvent","jsxs","jsx","SEO","SectionHeader","Fragment","post","CardItem","ProjectCard"],"ignoreList":[],"sources":["../../../src/pages/Search.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/integrations/supabase/client';\nimport SEO from '@/components/SEO';\nimport SectionHeader from '@/components/SectionHeader';\nimport CardItem from '@/components/ui/CardItem';\nimport ProjectCard from '@/components/ProjectCard';\nimport { POST_SEARCH_SELECT, PROJECT_SEARCH_SELECT } from '@/lib/content-selects';\nimport type { PostDetail, ProjectDetail } from '@/types/content';\n\nconst normalize = (value: string) => value.toLowerCase();\nconst includesNormalized = (text: string, normalizedQuery: string) =>\n  normalize(text).includes(normalizedQuery);\n\nconst Search = () => {\n  const [q, setQ] = useState('');\n  const [debounced, setDebounced] = useState('');\n\n  useEffect(() => {\n    const t = setTimeout(() => setDebounced(q.trim()), 250);\n    return () => clearTimeout(t);\n  }, [q]);\n\n  const { data: posts = [] } = useQuery({\n    queryKey: ['search-posts'],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('posts')\n        .select(POST_SEARCH_SELECT)\n        .order('published_date', { ascending: false });\n      if (error) throw error;\n      return (data as PostDetail[]) ?? [];\n    },\n    staleTime: 60_000,\n  });\n\n  const { data: projects = [] } = useQuery({\n    queryKey: ['search-projects'],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('projects')\n        .select(PROJECT_SEARCH_SELECT)\n        .order('created_at', { ascending: false });\n      if (error) throw error;\n      return (data as ProjectDetail[]) ?? [];\n    },\n    staleTime: 60_000,\n  });\n\n  const results = useMemo(() => {\n    if (!debounced) return { posts: [], projects: [] };\n    const term = normalize(debounced);\n    const postHits = posts.filter((p) => {\n      const haystack = [p.title, p.excerpt ?? '', p.body ?? ''];\n      return (\n        haystack.some((value) => includesNormalized(value, term)) ||\n        (p.tags || []).some((t) => includesNormalized(t, term))\n      );\n    });\n    const projectHits = projects.filter((p) => {\n      const haystack = [p.title, p.description ?? '', p.full_description ?? ''];\n      return (\n        haystack.some((value) => includesNormalized(value, term)) ||\n        (p.tech_tags || []).some((t) => includesNormalized(t, term))\n      );\n    });\n    return { posts: postHits, projects: projectHits };\n  }, [debounced, posts, projects]);\n\n  useEffect(() => {\n    if (debounced) import('@/lib/events').then(({ logEvent }) => logEvent('search_query', { q: debounced })).catch(() => {});\n  }, [debounced]);\n\n  return (\n    <div className=\"min-h-screen bg-black text-white section pt-14\">\n      <SEO\n        title=\"Search\"\n        description=\"Search posts and projects\"\n        type=\"website\"\n        schemaType=\"SearchResultsPage\"\n        noindex\n        nofollow\n        breadcrumbs={[\n          { name: 'Home', path: '/' },\n          { name: 'Search', path: '/search' },\n        ]}\n      />\n\n      <div className=\"container-site\">\n        <SectionHeader title={<span className=\"text-brand-gradient\">Search</span>} />\n\n        <div className=\"mb-8\">\n          <input\n            value={q}\n            onChange={(e) => setQ(e.target.value)}\n            placeholder=\"Search posts and projects...\"\n            className=\"w-full px-4 py-3 rounded-md bg-white/10 border border-white/10 focus:outline-none focus:ring-2 focus:ring-white/30\"\n          />\n        </div>\n\n        {debounced && (\n          <>\n            <h3 className=\"text-sm text-white/60 mb-3\">Posts ({results.posts.length})</h3>\n            {results.posts.length ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 grid-gap-default mb-10\">\n                {results.posts.map((post) => (\n                  <CardItem\n                    key={post.id}\n                    title={post.title}\n                    tags={post.tags || []}\n                    date={new Date(post.published_date).toLocaleDateString()}\n                    excerpt={post.excerpt || ''}\n                    linkTo={`/blogs/${post.slug}`}\n                    linkLabel=\"Read\"\n                    readTime={post.read_time || undefined}\n                    isBlog={true}\n                    image_url={post.image_url || undefined}\n                  />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-white/50 mb-10\">No posts found.</div>\n            )}\n\n            <h3 className=\"text-sm text-white/60 mb-3\">Projects ({results.projects.length})</h3>\n            {results.projects.length ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 grid-gap-default\">\n                {results.projects.map((p) => (\n                  <ProjectCard\n                    key={p.id}\n                    project={p}\n                    linkTo={`/projects/${p.id}`}\n                    linkLabel=\"View Project\"\n                  />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-white/50\">No projects found.</div>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Search;\n"],"file":"Search-Ds2na1Tj.js"}