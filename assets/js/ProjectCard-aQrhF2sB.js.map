{"version":3,"file":"ProjectCard-aQrhF2sB.js","sources":["../../../src/lib/github.ts","../../../src/hooks/useGithubRepoInfo.ts","../../../src/components/ProjectCard.tsx"],"sourcesContent":["export type GithubRepoRef = {\n  owner: string;\n  repo: string;\n};\n\nexport type GithubRepoInfo = {\n  full_name: string;\n  html_url: string;\n  homepage?: string | null;\n  description?: string | null;\n  language?: string | null;\n  stargazers_count: number;\n  open_issues_count: number;\n  pushed_at?: string | null;\n  updated_at?: string | null;\n};\n\nconst normalizeRepoName = (value: string) => value.replace(/\\.git$/i, '').trim();\n\nexport const parseGithubRepo = (repoUrl?: string | null): GithubRepoRef | null => {\n  if (!repoUrl) return null;\n  const trimmed = repoUrl.trim();\n  if (!trimmed) return null;\n\n  const sshMatch = trimmed.match(/^git@github\\.com:([^/]+)\\/([^/]+?)(?:\\.git)?$/i);\n  if (sshMatch) {\n    return { owner: sshMatch[1], repo: normalizeRepoName(sshMatch[2]) };\n  }\n\n  try {\n    const url = new URL(trimmed);\n    if (url.hostname !== 'github.com') return null;\n    const [, owner, repo] = url.pathname.split('/');\n    if (!owner || !repo) return null;\n    return { owner, repo: normalizeRepoName(repo) };\n  } catch {\n    return null;\n  }\n};\n","import { useQuery } from '@tanstack/react-query';\nimport { parseGithubRepo, type GithubRepoInfo } from '@/lib/github';\n\ntype CachedEntry = {\n  expiresAt: number;\n  data: GithubRepoInfo;\n};\n\nconst CACHE_TTL_MS = 1000 * 60 * 60 * 24; // 24h\n\nconst getCacheKey = (fullName: string) => `github_repo:${fullName.toLowerCase()}`;\n\nconst readCache = (key: string): GithubRepoInfo | null => {\n  if (typeof window === 'undefined') return null;\n  try {\n    const raw = window.localStorage.getItem(key);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw) as CachedEntry;\n    if (!parsed?.data || typeof parsed.expiresAt !== 'number') return null;\n    if (Date.now() > parsed.expiresAt) return null;\n    return parsed.data;\n  } catch {\n    return null;\n  }\n};\n\nconst writeCache = (key: string, data: GithubRepoInfo) => {\n  if (typeof window === 'undefined') return;\n  try {\n    const payload: CachedEntry = { data, expiresAt: Date.now() + CACHE_TTL_MS };\n    window.localStorage.setItem(key, JSON.stringify(payload));\n  } catch {\n    // ignore quota / private mode\n  }\n};\n\nconst readStaleCache = (key: string): GithubRepoInfo | null => {\n  if (typeof window === 'undefined') return null;\n  try {\n    const raw = window.localStorage.getItem(key);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw) as CachedEntry;\n    if (!parsed?.data) return null;\n    return parsed.data;\n  } catch {\n    return null;\n  }\n};\n\nexport const useGithubRepoInfo = (repoUrl?: string | null) => {\n  const repo = parseGithubRepo(repoUrl);\n  const fullName = repo ? `${repo.owner}/${repo.repo}` : null;\n\n  return useQuery({\n    queryKey: ['github-repo', fullName],\n    enabled: Boolean(fullName),\n    staleTime: CACHE_TTL_MS,\n    gcTime: CACHE_TTL_MS * 2,\n    retry: false,\n    queryFn: async () => {\n      if (!fullName) return null;\n      const cacheKey = getCacheKey(fullName);\n\n      const cached = readCache(cacheKey);\n      if (cached) return cached;\n\n      try {\n        const res = await fetch(`https://api.github.com/repos/${fullName}`, {\n          headers: {\n            Accept: 'application/vnd.github+json',\n          },\n        });\n\n        if (!res.ok) {\n          return readStaleCache(cacheKey);\n        }\n\n        const json = (await res.json()) as GithubRepoInfo;\n        if (!json?.full_name) return readStaleCache(cacheKey);\n\n        writeCache(cacheKey, json);\n        return json;\n      } catch {\n        return readStaleCache(cacheKey);\n      }\n    },\n  });\n};\n\n","import CardItem from '@/components/ui/CardItem';\nimport type { ProjectSummary } from '@/types/content';\nimport { useGithubRepoInfo } from '@/hooks/useGithubRepoInfo';\n\ntype ProjectCardProps = {\n  project: ProjectSummary;\n  linkTo: string;\n  linkLabel?: string;\n};\n\nconst ProjectCard = ({ project, linkTo, linkLabel = 'View Project' }: ProjectCardProps) => {\n  const { data: repoInfo } = useGithubRepoInfo(project.repo_url);\n  const fallbackDescription =\n    project.description?.trim() ||\n    repoInfo?.description?.trim() ||\n    (project.tech_tags?.length ? `Built with ${project.tech_tags.slice(0, 3).join(', ')}.` : '');\n\n  return (\n    <CardItem\n      title={project.title}\n      tags={project.tech_tags || []}\n      description={fallbackDescription}\n      linkTo={linkTo}\n      linkLabel={linkLabel}\n      githubUrl={project.repo_url || undefined}\n      demoUrl={project.demo_url || undefined}\n      image_url={project.image_url || undefined}\n      repoStars={repoInfo?.stargazers_count ?? null}\n      repoUpdatedAt={repoInfo?.pushed_at ?? repoInfo?.updated_at ?? null}\n    />\n  );\n};\n\nexport default ProjectCard;\n"],"names":["normalizeRepoName","value","parseGithubRepo","repoUrl","trimmed","sshMatch","url","owner","repo","CACHE_TTL_MS","getCacheKey","fullName","readCache","key","raw","parsed","writeCache","data","payload","readStaleCache","useGithubRepoInfo","useQuery","cacheKey","cached","res","json","ProjectCard","project","linkTo","linkLabel","repoInfo","fallbackDescription","jsx","CardItem"],"mappings":"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"}