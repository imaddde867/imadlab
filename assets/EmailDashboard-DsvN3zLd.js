import{r,j as e,b8 as Ce,b9 as Ee,ba as Te,bb as it,bc as Pe,bd as nt,a$ as rt,be as ke,n as lt,bf as ct,b1 as $,bg as J,bh as ot,b6 as dt}from"./vendor-BWaHT4c5.js";import{c as P,u as pt,s as u,B as g,D as K,a as X,b as Z,d as ee,e as te,f as se}from"./index-C2wzmnot.js";import{C as M,d as L,a as ae,b as ie,c as ne}from"./card-F9rnObCZ.js";import{P as mt,T as I}from"./page-header-B__z29Lg.js";import{C as xt}from"./LoadingStates-Bc7aBWMd.js";const ut=it,Re=r.forwardRef(({className:o,...l},h)=>e.jsx(Ce,{ref:h,className:P("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",o),...l}));Re.displayName=Ce.displayName;const B=r.forwardRef(({className:o,...l},h)=>e.jsx(Ee,{ref:h,className:P("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",o),...l}));B.displayName=Ee.displayName;const U=r.forwardRef(({className:o,...l},h)=>e.jsx(Te,{ref:h,className:P("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",o),...l}));U.displayName=Te.displayName;const pe=r.forwardRef(({className:o,...l},h)=>e.jsx(Pe,{className:P("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",o),...l,ref:h,children:e.jsx(nt,{className:P("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));pe.displayName=Pe.displayName;const ht=o=>o==="project"?"project":"blog_post",bt=o=>{switch(o){case"processing":case"sent":case"failed":return o;case"pending":default:return"pending"}},re="rounded-2xl border border-white/10 bg-white/[0.06] shadow-sm",le="px-6 pt-6 pb-0",ce="text-lg font-semibold text-white",oe="text-sm text-white/70",de="px-6 pb-6 space-y-6",ft="bg-white text-black border border-white/80 shadow-sm",gt="bg-black/40 text-white/75 hover:bg-white/10 hover:text-white",vt="text-xs uppercase tracking-widest text-white/70",St=()=>{const o=rt(),{toast:l}=pt(),[h,me]=r.useState(null),[R,Ae]=r.useState([]),[b,De]=r.useState(null),[O,xe]=r.useState(!0),[w,A]=r.useState(!1),[ue,F]=r.useState(""),[Q,he]=r.useState(!1),[H,V]=r.useState(""),[v,qe]=r.useState([]),[ze,$e]=r.useState({}),[D,Me]=r.useState("all"),[Le,Ie]=r.useState({}),[N,Be]=r.useState(!0),[y,Ue]=r.useState(!0),_=r.useCallback(async()=>{try{xe(!0);const{data:t,error:s}=await u.from("email_queue").select("*").order("created_at",{ascending:!1}).limit(50);if(s)throw s;const i=(t??[]).map(n=>({...n,content_type:ht(n.content_type??null),status:bt(n.status??null)})),c=i.filter(n=>n.content_type==="blog_post").map(n=>n.content_id),d=i.filter(n=>n.content_type==="project").map(n=>n.content_id),[p,m]=await Promise.all([c.length>0?u.from("posts").select("id, title").in("id",c):Promise.resolve({data:[]}),d.length>0?u.from("projects").select("id, title").in("id",d):Promise.resolve({data:[]})]),k=new Map((p.data||[]).map(n=>[n.id,n.title])),Ke=new Map((m.data||[]).map(n=>[n.id,n.title])),Xe=i.map(n=>({...n,content_title:n.content_type==="blog_post"?k.get(n.content_id):Ke.get(n.content_id)}));Ae(Xe);const[{data:we},{data:je}]=await Promise.all([u.from("newsletter_subscribers").select("status, email, created_at, updated_at"),u.from("email_analytics").select("*")]);if(we&&je){const n=we,C=je,Ze=n.length,et=n.filter(a=>!a.status||a.status==="active").length,E=C.filter(a=>a.sent_at).length,T=C.filter(a=>a.delivered_at).length,tt=C.filter(a=>a.opened_at).length,st=C.filter(a=>a.clicked_at).length,at=n.map(a=>({email:a.email,status:a.status??"active",created_at:a.created_at??void 0,updated_at:a.updated_at??void 0})),q={},z={};C.forEach(a=>{const j=a.subscriber_email;q[j]||(q[j]={sent:0,delivered:0,opened:0,clicked:0,bounced:0,lastEvent:void 0});const f=q[j];a.sent_at&&(f.sent+=1),a.delivered_at&&(f.delivered+=1),a.opened_at&&(f.opened+=1),a.clicked_at&&(f.clicked+=1),a.bounced_at&&(f.bounced+=1);const Se=[a.clicked_at,a.opened_at,a.delivered_at,a.sent_at,a.bounced_at,a.unsubscribed_at].filter(Boolean).map(x=>new Date(x).getTime());if(Se.length){const x=Math.max(...Se);(!f.lastEvent||x>new Date(f.lastEvent).getTime())&&(f.lastEvent=new Date(x).toISOString())}if(a.email_queue_id){z[a.email_queue_id]||(z[a.email_queue_id]={metrics:{sent:0,delivered:0,opened:0,clicked:0,bounced:0,uniqueRecipients:0},recipients:new Set});const x=z[a.email_queue_id];x.recipients.add(a.subscriber_email),a.sent_at&&(x.metrics.sent+=1),a.delivered_at&&(x.metrics.delivered+=1),a.opened_at&&(x.metrics.opened+=1),a.clicked_at&&(x.metrics.clicked+=1),a.bounced_at&&(x.metrics.bounced+=1)}});const Ne={};Object.entries(z).forEach(([a,j])=>{Ne[a]={...j.metrics,uniqueRecipients:j.recipients.size}}),qe(at),$e(q),Ie(Ne);const ye=T>0?T:E,_e=T>0?T:E;De({totalSubscribers:Ze,activeSubscribers:et,totalEmailsSent:E,deliveryRate:E>0?T/E*100:0,openRate:ye>0?tt/ye*100:0,clickRate:_e>0?st/_e*100:0})}}catch(t){console.error("Error loading email data:",t),l({title:"Error",description:"Failed to load email data",variant:"destructive"})}finally{xe(!1)}},[l]);r.useEffect(()=>{(async()=>{const{data:i}=await u.auth.getUser();if(!i.user){o("/admin/login"),l({title:"Unauthorized",description:"Please log in to access the admin dashboard.",variant:"destructive"});return}me({email:i.user.email}),await _()})();const{data:s}=u.auth.onAuthStateChange((i,c)=>{c!=null&&c.user?me({email:c.user.email}):o("/admin/login")});return()=>{s==null||s.subscription.unsubscribe()}},[_,o,l]);const be=async t=>{try{A(!0);const{data:s,error:i}=await u.functions.invoke("send-newsletter-emails",{method:"POST",body:t&&t.length?{queueIds:t}:{}});if(i)throw i;l({title:"Success",description:`Processed ${(s==null?void 0:s.processedItems)??0} email queue items`}),await _()}catch(s){console.error("Error processing email queue:",s),l({title:"Error",description:"Failed to process email queue",variant:"destructive"})}finally{A(!1)}},Oe=async t=>{await be([t])},Fe=async t=>{if(confirm("Delete this queue entry? This cannot be undone."))try{A(!0);const{error:s}=await u.from("email_queue").delete().eq("id",t);if(s)throw s;l({title:"Queue item deleted",description:"The email entry has been removed."}),await _()}catch(s){console.error(`Error deleting queue item ${t}:`,s),l({title:"Error",description:"Failed to delete this queue item.",variant:"destructive"})}finally{A(!1)}},fe=r.useMemo(()=>D==="all"?v:v.filter(t=>(t.status??"active")===D),[v,D]),Y=v.length,ge=v.filter(t=>(t.status??"active")==="active").length,Qe=v.filter(t=>t.status==="inactive").length,He=v.filter(t=>t.status==="unsubscribed").length,Ve=r.useMemo(()=>[{label:`${R.length} queue items`,variant:"outline"},{label:`Blog auto-send ${N?"on":"off"}`,variant:N?"success":"warning"},{label:`Project auto-send ${y?"on":"off"}`,variant:y?"success":"warning"},{label:`${Y} subscribers`,variant:"neutral"}],[N,R.length,y,Y]),ve=r.useMemo(()=>{if(!b)return[];const t=s=>`${s.toFixed(1)}%`;return[{label:"Total Subscribers",value:b.totalSubscribers,icon:e.jsx(ke,{className:"h-4 w-4 text-white/80","aria-hidden":"true"})},{label:"Active Subscribers",value:b.activeSubscribers,icon:e.jsx(ke,{className:"h-4 w-4 text-emerald-300","aria-hidden":"true"})},{label:"Emails Sent",value:b.totalEmailsSent,icon:e.jsx(lt,{className:"h-4 w-4 text-sky-300","aria-hidden":"true"})},{label:"Delivery Rate",value:t(b.deliveryRate),icon:e.jsx(ct,{className:"h-4 w-4 text-purple-300","aria-hidden":"true"})},{label:"Open Rate",value:t(b.openRate),icon:e.jsx($,{className:"h-4 w-4 text-amber-300","aria-hidden":"true"})},{label:"Click Rate",value:t(b.clickRate),icon:e.jsx(J,{className:"h-4 w-4 text-blue-300","aria-hidden":"true"})}]},[b]),G=async t=>{try{V("Email Preview"),he(!0),F("");const s=window.location.origin,i=p=>p==="blog_post"?"posts":"projects";let c=null,d;if(t.mode==="queue"){d=t.queueItem.content_type;const p=i(d),{data:m,error:k}=await u.from(p).select("*").eq("id",t.queueItem.content_id).single();if(k||!m){l({title:"Error",description:"Unable to load content for this queue item.",variant:"destructive"});return}c=m,V(`${d==="blog_post"?"Blog Post":"Project"} • ${c.title}`)}else{d=t.contentType;const p=i(d),{data:m,error:k}=await u.from(p).select("*").order("created_at",{ascending:!1}).limit(1).maybeSingle();if(k||!m){l({title:"Error",description:`No recent ${d==="blog_post"?"blog posts":"projects"} found.`,variant:"destructive"});return}c=m,V(`Latest ${d==="blog_post"?"Blog Post":"Project"} • ${c.title}`)}F(d==="blog_post"?Ye({subscriberEmail:"preview@example.com",unsubscribeToken:"preview-token",siteUrl:s,post:c}):Ge({subscriberEmail:"preview@example.com",unsubscribeToken:"preview-token",siteUrl:s,project:c}))}catch(s){console.error("Error generating preview:",s),l({title:"Error",description:"Failed to generate email preview",variant:"destructive"})}finally{he(!1)}},W=()=>Q?e.jsx("div",{className:"flex items-center justify-center py-16 text-white/60",children:"Generating preview…"}):ue?e.jsx("div",{className:"border border-white/10 rounded-lg p-4 bg-black",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:ue}})}):e.jsx("div",{className:"flex items-center justify-center py-12 text-white/55",children:"Preview will appear here when generated."}),Ye=t=>{const{post:s}=t,i=new Date(s.published_date||s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return`
      <div style="max-width: 600px; margin: 0 auto; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #000000; border: 1px solid #1a1a1a; border-radius: 12px; overflow: hidden;">
        <div style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); padding: 48px 32px; text-align: center; border-bottom: 1px solid #1a1a1a;">
          <div style="font-size: 32px; font-weight: 700; color: #ffffff; margin-bottom: 8px; letter-spacing: -0.02em;">imadlab</div>
          <div style="color: #888888; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.1em;">New Blog Post</div>
        </div>
        <div style="padding: 48px 32px;">
          <h1 style="font-size: 28px; font-weight: 700; color: #ffffff; margin-bottom: 16px; line-height: 1.2; letter-spacing: -0.02em;">${s.title}</h1>
          <div style="color: #666666; font-size: 13px; font-weight: 500; margin-bottom: 24px; text-transform: uppercase; letter-spacing: 0.05em;">
            ${i}
          </div>
          <div style="color: #cccccc; font-size: 16px; line-height: 1.7; margin-bottom: 32px;">
            ${s.excerpt||"Dive into the latest insights on data engineering, AI/ML, and cutting-edge web development techniques."}
          </div>
          <div style="height: 1px; background: linear-gradient(90deg, transparent 0%, #333333 50%, transparent 100%); margin: 24px 0;"></div>
          <a href="#" style="display: inline-block; background-color: #ffffff; color: #000000; text-decoration: none; padding: 16px 32px; border-radius: 8px; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em; border: 2px solid #ffffff;">Read Article</a>
        </div>
        <div style="background-color: #0a0a0a; padding: 32px; text-align: center; border-top: 1px solid #1a1a1a;">
          <div style="color: #666666; font-size: 13px; line-height: 1.6; margin-bottom: 16px;">
            You're receiving this because you subscribed to imadlab updates.<br>
            Stay ahead with the latest in tech and development.
          </div>
          <a href="#" style="color: #888888; text-decoration: none; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 500;">Unsubscribe</a>
        </div>
      </div>
    `},Ge=t=>{const{project:s}=t,i=(s.tech_tags??[]).map(c=>`<span style="display: inline-block; background-color: #1a1a1a; color: #ffffff; padding: 8px 16px; border-radius: 6px; font-size: 11px; font-weight: 500; margin-right: 8px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em; border: 1px solid #333333;">${c}</span>`).join("");return`
      <div style="max-width: 600px; margin: 0 auto; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #000000; border: 1px solid #1a1a1a; border-radius: 12px; overflow: hidden;">
        <div style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); padding: 48px 32px; text-align: center; border-bottom: 1px solid #1a1a1a;">
          <div style="font-size: 32px; font-weight: 700; color: #ffffff; margin-bottom: 8px; letter-spacing: -0.02em;">imadlab</div>
          <div style="color: #888888; font-size: 14px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.1em;">New Project</div>
        </div>
        <div style="padding: 48px 32px;">
          <h1 style="font-size: 28px; font-weight: 700; color: #ffffff; margin-bottom: 24px; line-height: 1.2; letter-spacing: -0.02em;">${s.title}</h1>
          <div style="color: #cccccc; font-size: 16px; line-height: 1.7; margin-bottom: 32px;">
            ${s.description||"Explore this new project showcasing innovative solutions and modern development practices."}
          </div>
          ${i?`
          <div style="margin-bottom: 40px;">
            <div style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.05em;">Tech Stack</div>
            ${i}
          </div>
          `:""}
          <div style="height: 1px; background: linear-gradient(90deg, transparent 0%, #333333 50%, transparent 100%); margin: 32px 0;"></div>
          <div style="display: flex; gap: 16px; flex-wrap: wrap;">
            <a href="#" style="display: inline-block; background-color: #ffffff; color: #000000; text-decoration: none; padding: 16px 24px; border-radius: 8px; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em; border: 2px solid #ffffff; flex: 1; min-width: 140px; text-align: center;">View Project</a>
            ${s.repo_url?'<a href="#" style="display: inline-block; background-color: transparent; color: #ffffff; text-decoration: none; padding: 16px 24px; border-radius: 8px; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em; border: 2px solid #333333; flex: 1; min-width: 140px; text-align: center;">View Code</a>':""}
          </div>
        </div>
        <div style="background-color: #0a0a0a; padding: 32px; text-align: center; border-top: 1px solid #1a1a1a;">
          <div style="color: #666666; font-size: 13px; line-height: 1.6; margin-bottom: 16px;">
            You're receiving this because you subscribed to imadlab updates.<br>
            Discover cutting-edge projects and technical innovations.
          </div>
          <a href="#" style="color: #888888; text-decoration: none; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 500;">Unsubscribe</a>
        </div>
      </div>
    `},We=t=>{const s={pending:"outline",processing:"info",sent:"success",failed:"danger"},i=t.charAt(0).toUpperCase()+t.slice(1);return e.jsx(I,{variant:s[t]??"outline",size:"xs",className:"uppercase tracking-wide text-[11px]",children:i})},Je=t=>{const s=t??"active",i=s.charAt(0).toUpperCase()+s.slice(1),d={active:"success",inactive:"warning",unsubscribed:"danger"}[s]??"outline";return e.jsx(I,{variant:d,size:"xs",className:"uppercase tracking-wide text-[11px]",children:i})},S=t=>{if(!t)return"—";const s=new Date(t);return Number.isNaN(s.getTime())?"—":s.toLocaleString()};return h===null||O?e.jsx("div",{className:"min-h-screen bg-black text-white",children:e.jsx(xt,{className:"min-h-screen",text:"Loading email dashboard...",variant:"orbit"})}):e.jsx("div",{className:"min-h-screen bg-black text-white py-12",children:e.jsxs("div",{className:"container-site space-y-10 pb-24",children:[e.jsx(mt,{eyebrow:"Admin Suite",title:"Email Management",description:"Monitor automations, deliver campaigns, and keep the audience up to date.",breadcrumbs:[{label:"Admin",href:"/admin"},{label:"Emails",href:"/admin/emails"}],meta:Ve,actions:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(g,{variant:"soft",onClick:_,disabled:O,children:[e.jsx(ot,{className:`mr-2 h-4 w-4 ${O?"animate-spin":""}`}),"Refresh"]}),e.jsxs(g,{variant:"inverted",onClick:()=>be(),disabled:w,children:[e.jsx(J,{className:`mr-2 h-4 w-4 ${w?"animate-pulse":""}`}),w?"Processing…":"Process Queue"]})]}),children:!!ve.length&&e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:ve.map(t=>e.jsx(M,{className:"rounded-2xl border border-white/10 bg-white/5 shadow-[0_16px_48px_rgba(15,23,42,0.35)] backdrop-blur-sm",children:e.jsx(L,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-xl bg-white/10",children:t.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.25em] text-white/60",children:t.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.value})]})]})})},t.label))})}),e.jsxs(ut,{defaultValue:"queue",className:"w-full",children:[e.jsxs(Re,{className:"grid w-full grid-cols-3 rounded-2xl border border-white/10 bg-white/[0.05] p-1",children:[e.jsx(B,{value:"queue",className:"rounded-xl px-4 py-2 text-sm font-semibold text-white/70 transition data-[state=active]:bg-white data-[state=active]:text-black data-[state=active]:shadow-sm",children:"Email Queue"}),e.jsx(B,{value:"subscribers",className:"rounded-xl px-4 py-2 text-sm font-semibold text-white/70 transition data-[state=active]:bg-white data-[state=active]:text-black data-[state=active]:shadow-sm",children:"Subscribers"}),e.jsx(B,{value:"settings",className:"rounded-xl px-4 py-2 text-sm font-semibold text-white/70 transition data-[state=active]:bg-white data-[state=active]:text-black data-[state=active]:shadow-sm",children:"Settings"})]}),e.jsx(U,{value:"queue",className:"space-y-4",children:e.jsxs(M,{className:re,children:[e.jsxs(ae,{className:`${le} space-y-1`,children:[e.jsx(ie,{className:ce,children:"Email Queue"}),e.jsx(ne,{className:oe,children:"Manage pending and processed email notifications"})]}),e.jsx(L,{className:`${de} pt-4`,children:R.length===0?e.jsx("p",{className:"text-white/60 text-center py-8",children:"No email queue items found"}):e.jsx("div",{className:"space-y-4",children:R.map(t=>{const s=Le[t.id]??{sent:0,delivered:0,opened:0,clicked:0,bounced:0,uniqueRecipients:0},i=t.status==="pending"||t.status==="failed",c=t.status==="failed"?"Retry":"Send Now",d=i?ge:s.uniqueRecipients||s.sent||s.delivered||0,p=t.content_type==="blog_post"?"Blog Post":"Project",m=t.content_title||"Untitled";return e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/[0.06] p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:m}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"xs",className:"text-white/80",children:p}),We(t.status),t.retry_count>0&&e.jsxs(I,{variant:"warning",size:"xs",className:"text-amber-100",children:["Retry ",t.retry_count]})]})]}),e.jsxs("div",{className:"text-sm leading-relaxed text-white/70 space-y-1",children:[e.jsxs("div",{children:["Queued: ",S(t.created_at)]}),t.sent_at&&e.jsxs("div",{children:["Sent: ",S(t.sent_at)]}),t.error_message&&e.jsxs("div",{className:"text-red-400",children:["Error: ",t.error_message]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:justify-end",children:[e.jsxs(K,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(g,{variant:"soft",size:"sm",className:"data-[state=open]:bg-white/15",onClick:()=>G({mode:"queue",queueItem:t}),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsxs(Z,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-slate-900 text-white border border-white/10",children:[e.jsxs(ee,{children:[e.jsx(te,{children:H||"Email Preview"}),e.jsx(se,{className:"text-white/60",children:"Preview of the message generated for this queue item."})]}),W()]})]}),e.jsxs(g,{variant:"soft",size:"sm",className:`border-emerald-400/40 bg-emerald-500/20 text-emerald-100 hover:bg-emerald-500/25 ${i?"":"opacity-50 cursor-not-allowed hover:bg-emerald-500/20"}`,disabled:w||!i,title:i?"Send this email now":"Only pending or failed items can be resent",onClick:()=>Oe(t.id),children:[e.jsx(J,{className:`w-4 h-4 mr-2 ${w?"animate-pulse":""}`}),i?c:t.status==="sent"?"Processed":t.status==="processing"?"Processing":"Queued"]}),e.jsxs(g,{variant:"destructive",size:"sm",disabled:w,title:"Remove this queue item",onClick:()=>Fe(t.id),children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-6 gap-3 text-xs uppercase tracking-wide text-white/65",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Recipients"}),e.jsx("p",{className:"text-base font-semibold text-white",children:d})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Sent"}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.sent})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Delivered"}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.delivered})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Opened"}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.opened})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Clicked"}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.clicked})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-widest text-white/60",children:"Bounced"}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.bounced})]})]})]},t.id)})})})]})}),e.jsx(U,{value:"subscribers",className:"space-y-4",children:e.jsxs(M,{className:re,children:[e.jsx(ae,{className:`${le} space-y-1`,children:e.jsxs("div",{className:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx(ie,{className:ce,children:"Subscribers"}),e.jsx(ne,{className:oe,children:"Monitor list health and engagement performance"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs font-medium text-white/60",children:[e.jsxs("span",{children:["Total: ",Y]}),e.jsxs("span",{children:["Active: ",ge]}),e.jsxs("span",{children:["Inactive: ",Qe]}),e.jsxs("span",{children:["Unsubscribed: ",He]})]})]})}),e.jsxs(L,{className:`${de} pt-4`,children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","active","inactive","unsubscribed"].map(t=>{const s=D===t,i=t==="all"?"All":t.charAt(0).toUpperCase()+t.slice(1);return e.jsx(g,{variant:"outline",size:"sm",onClick:()=>Me(t),className:`border-white/20 transition-colors ${s?ft:gt}`,children:i},t)})}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-white/10 bg-black/40",children:e.jsxs("table",{className:"min-w-full divide-y divide-white/10",children:[e.jsx("thead",{className:"bg-white/5",children:e.jsxs("tr",{className:vt,children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Subscriber"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Sent"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Delivered"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Opened"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Clicked"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Bounced"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Last Activity"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium",children:"Subscribed"})]})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:fe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-white/50",children:"No subscribers match the selected filter."})}):fe.map(t=>{const s=ze[t.email]??{sent:0,delivered:0,opened:0,clicked:0,bounced:0,lastEvent:void 0},i=t.status??"active";return e.jsxs("tr",{className:"text-sm text-white/80",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-base font-semibold text-white",children:t.email}),e.jsxs("span",{className:"text-xs text-white/50",children:["Last updated: ",S(t.updated_at)]})]})}),e.jsx("td",{className:"px-4 py-3",children:Je(i)}),e.jsx("td",{className:"px-4 py-3",children:s.sent}),e.jsx("td",{className:"px-4 py-3",children:s.delivered}),e.jsx("td",{className:"px-4 py-3",children:s.opened}),e.jsx("td",{className:"px-4 py-3",children:s.clicked}),e.jsx("td",{className:"px-4 py-3",children:s.bounced}),e.jsx("td",{className:"px-4 py-3",children:S(s.lastEvent)}),e.jsx("td",{className:"px-4 py-3",children:S(t.created_at)})]},t.email)})})]})})]})]})}),e.jsx(U,{value:"settings",className:"space-y-4",children:e.jsxs(M,{className:re,children:[e.jsxs(ae,{className:`${le} space-y-1`,children:[e.jsx(ie,{className:ce,children:"Email Settings"}),e.jsx(ne,{className:oe,children:"Configure email notification preferences and preview templates"})]}),e.jsx(L,{className:`${de} pt-4`,children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:"Auto-send Blog Post Emails"}),e.jsx("p",{className:"text-sm text-white/60 mt-1",children:"Automatically send emails when new blog posts are published"}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(pe,{checked:N,onCheckedChange:Be,"aria-label":"Toggle blog auto-send"}),e.jsx("span",{className:"text-xs font-medium text-white/60",children:N?"Enabled":"Disabled"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(K,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(g,{variant:"soft",size:"sm",onClick:()=>G({mode:"latest",contentType:"blog_post"}),disabled:Q,className:"data-[state=open]:bg-white/15",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsxs(Z,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-slate-900 text-white border border-white/10",children:[e.jsxs(ee,{children:[e.jsx(te,{children:H||"Email Preview"}),e.jsx(se,{className:"text-white/60",children:"Preview of how blog post notification emails will appear to subscribers"})]}),W()]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:"Auto-send Project Emails"}),e.jsx("p",{className:"text-sm text-white/60 mt-1",children:"Automatically send emails when new projects are published"}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(pe,{checked:y,onCheckedChange:Ue,"aria-label":"Toggle project auto-send"}),e.jsx("span",{className:"text-xs font-medium text-white/60",children:y?"Enabled":"Disabled"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(K,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(g,{variant:"soft",size:"sm",onClick:()=>G({mode:"latest",contentType:"project"}),disabled:Q,className:"data-[state=open]:bg-white/15",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsxs(Z,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-slate-900 text-white border border-white/10",children:[e.jsxs(ee,{children:[e.jsx(te,{children:H||"Email Preview"}),e.jsx(se,{className:"text-white/60",children:"Preview of how project notification emails will appear to subscribers"})]}),W()]})]})})]})]})})]})})]})]})})};export{St as default};
